{
  "id": "1e74fe29-55b2-4c73-9d6a-1fcf5eefd286",
  "name": "CZR-Workflow-ServiceNowCatalog-Timebound - Teams Record",
  "description": "Teams Recording access Timebound will be controlled thru this workflow. After the period listed for each role, access will be automatically revoked. Approval must follow the next-level reporting structure, and then proceed to management for final authorization.",
  "created": "2025-10-01T21:11:46.018132827Z",
  "modified": "2025-10-23T21:53:39.520802966Z",
  "modifiedBy": {
    "type": "IDENTITY",
    "id": "9880e87611d64a5b9a6c66acd11b7301",
    "name": "Lingareddy Some"
  },
  "definition": {
    "start": "Define Variable 1",
    "steps": {
      "Compare Strings 4": {
        "actionId": "sp:compare-strings",
        "choiceList": [
          {
            "comparator": "StringEquals",
            "nextStep": "Define Variable 5",
            "variableA.$": "$.defineVariable1.roleName",
            "variableB": "Teams Recording 30 day access [cloudRole-1753379940658]"
          }
        ],
        "defaultStep": "End Step - Failure",
        "description": "Teams Recording 30 day access",
        "displayName": "Microsoft Teams Recording - 30 Day Access",
        "type": "choice"
      },
      "Define Variable 1": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "attributeValue",
              "name": "roleName",
              "transforms": [],
              "variableA.$": "$.trigger.accountRequests[0].attributeRequests[0].attributeValue"
            }
          ]
        },
        "displayName": "",
        "nextStep": "Compare Strings 4",
        "type": "Mutation"
      },
      "Define Variable 5": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "removalDate",
              "name": "removalDate",
              "transforms": [
                {
                  "id": "sp:transform:addTime:time",
                  "input": {
                    "length": 2,
                    "unit": "days"
                  }
                }
              ],
              "variableA.$": "$.now()"
            }
          ]
        },
        "displayName": "",
        "nextStep": "HTTP Request 4",
        "type": "Mutation"
      },
      "End Step - Failure": {
        "actionId": "sp:operator-failure",
        "description": "Failed to find group",
        "displayName": "",
        "failureName": "Failed to find group",
        "type": "failure"
      },
      "End Step - Success": {
        "actionId": "sp:operator-success",
        "displayName": "",
        "type": "success"
      },
      "HTTP Request 4": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "clientMetadata": null,
            "requestType": "REVOKE_ACCESS",
            "requestedFor": [
              "{{$.trigger.recipient.id}}"
            ],
            "requestedItems": [
              {
                "clientMetadata": null,
                "comment": "Microsoft Teams Recording - 30 Day Access -Active Directory group has been automatically removed by ISC. If you believe this is an error, please reach out to your manager or the Team AD group owner for assistance.",
                "id": "d08b92f5ba9f48dfa4bbbe6934ce1741",
                "removeDate": "{{$.defineVariable5.removalDate}}",
                "type": "ROLE"
              }
            ]
          },
          "method": "post",
          "oAuthClientId": "f7f34d9888cd4b0cb8123b7ed92c427f",
          "oAuthClientSecret": "$.secrets.c835b5e8-ffa1-4784-a45b-9cc5e99a214c",
          "oAuthCredentialLocation": "oAuthInBody",
          "oAuthScope": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "requestHeaders": null,
          "url": "https://caesars-sb.api.identitynow.com/v2024/access-requests"
        },
        "description": "USB Read and Write 30 Day revoke access",
        "displayName": "",
        "nextStep": "End Step - Success",
        "type": "action",
        "versionNumber": 2
      }
    }
  },
  "enabled": true,
  "creator": {
    "type": "IDENTITY",
    "id": "9880e87611d64a5b9a6c66acd11b7301",
    "name": "Lingareddy Some"
  },
  "owner": {
    "type": "IDENTITY",
    "id": "a0d9586ce9314f9f89c2d094dca4e27e",
    "name": "500000384"
  },
  "trigger": {
    "type": "EVENT",
    "attributes": {
      "filter.$": "$.accountRequests[?( @.accountOperation == 'Modify' && @.provisioningResult == 'committed')].attributeRequests[?(@.operation == \"Add\" && ( @.attributeValue == \"CN=Teams Recording 30 day access,OU=Okta,OU=Applications,OU=SailPointUsers,DC=dev,DC=lab,DC=local\"))]",
      "id": "idn:post-provisioning"
    }
  }
}