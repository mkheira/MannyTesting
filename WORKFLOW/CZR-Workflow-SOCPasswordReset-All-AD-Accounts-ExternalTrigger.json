{
  "id": "24e5b256-9cde-4d16-95b2-bd036be4bae9",
  "name": "CZR-Workflow-SOCPasswordReset-All-AD-Accounts-ExternalTrigger",
  "description": "SOC uses this launcher to scramble password for the selected User",
  "created": "2025-12-03T21:11:16.984374462Z",
  "modified": "2025-12-24T14:56:17.465215772Z",
  "modifiedBy": {
    "type": "IDENTITY",
    "id": "0d33b7ad3c3f48b8a6df327c5c77bb49",
    "name": "500000530"
  },
  "definition": {
    "start": "Define Variable",
    "steps": {
      "Compare Strings 3": {
        "actionId": "sp:compare-strings",
        "choiceList": [
          {
            "comparator": "StringDoesNotEquals",
            "nextStep": "HTTP Request 2",
            "variableA.$": "$.defineVariable.personNumber",
            "variableB": ""
          }
        ],
        "defaultStep": "Verify Data Type 1",
        "displayName": "",
        "type": "choice"
      },
      "Define Variable": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "sAMAccountName",
              "transforms": [],
              "variableA.$": "$.trigger.SAMAccountName"
            },
            {
              "description": "",
              "name": "operation",
              "transforms": [],
              "variableA.$": "$.trigger.Operation"
            },
            {
              "description": "",
              "name": "comments",
              "transforms": [],
              "variableA.$": "$.trigger.Comments"
            },
            {
              "description": "",
              "name": "personNumber",
              "transforms": [],
              "variableA.$": "$.trigger.PersonNumber"
            },
            {
              "description": "",
              "name": "FName",
              "transforms": [],
              "variableA.$": "$.trigger.FirstName"
            },
            {
              "description": "",
              "name": "LName",
              "transforms": [],
              "variableA.$": "$.trigger.LastName"
            },
            {
              "description": "",
              "name": "displayName",
              "transforms": [],
              "variableA.$": "$.trigger.DisplayName"
            },
            {
              "description": "",
              "name": "userEmail",
              "transforms": [],
              "variableA.$": "$.trigger.UserEmail"
            },
            {
              "description": "",
              "name": "requestedBy",
              "transforms": [],
              "variableA.$": "$.trigger.RequestedBy"
            },
            {
              "description": "",
              "name": "triggeredDate",
              "transforms": [
                {
                  "id": "sp:transform:formatDate:string",
                  "input": {
                    "dateFormat": "MM/DD/YYYY",
                    "style": "number",
                    "timeFormat": "HH:MM:SS"
                  }
                }
              ],
              "variableA.$": "$.now()"
            }
          ]
        },
        "displayName": "",
        "nextStep": "Verify Data Type 3",
        "type": "Mutation"
      },
      "Define Variable 1": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "adUrlByPersonId",
              "transforms": [
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "identity_id",
                    "replacement.$": "$.hTTPRequest2.body[0].id"
                  }
                }
              ],
              "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=identityId eq \"identity_id\" and source.displayableName in (\"CZR-Application-ActiveDirectory-Harrahs\",\"CZR-Application-ActiveDirectory-Harrahs-JAccounts\",\"CZR-Application-ActiveDirectory-WilliamHill\")"
            },
            {
              "description": "",
              "name": "identityUUID",
              "transforms": [],
              "variableA.$": "$.hTTPRequest2.body[0].id"
            }
          ]
        },
        "displayName": "",
        "nextStep": "HTTP Request 3",
        "type": "Mutation"
      },
      "Define Variable 3": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "adAccountURL",
              "transforms": [
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "sAMAccountName",
                    "replacement.$": "$.defineVariable.sAMAccountName"
                  }
                }
              ],
              "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=name eq \"sAMAccountName\""
            }
          ]
        },
        "displayName": "",
        "nextStep": "HTTP Request 1",
        "type": "Mutation"
      },
      "Define Variable 4": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "adUrlByIdentityId",
              "transforms": [
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "identity_id",
                    "replacement.$": "$.hTTPRequest1.body[0].identity.id"
                  }
                }
              ],
              "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=identityId eq \"identity_id\" and source.displayableName in (\"CZR-Application-ActiveDirectory-Harrahs\",\"CZR-Application-ActiveDirectory-Harrahs-JAccounts\",\"CZR-Application-ActiveDirectory-WilliamHill\")"
            },
            {
              "description": "",
              "name": "identityUUID",
              "transforms": [],
              "variableA.$": "$.hTTPRequest1.body[0].identity.id"
            }
          ]
        },
        "displayName": "",
        "nextStep": "HTTP Request",
        "type": "Mutation"
      },
      "Define Variable 5": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "adUrlByUserDisplayName",
              "transforms": [
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "identity_name",
                    "replacement.$": "$.defineVariable.displayName"
                  }
                }
              ],
              "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=identity.name eq \"identity_name\" and source.displayableName in (\"CZR-Application-ActiveDirectory-Harrahs\",\"CZR-Application-ActiveDirectory-Harrahs-JAccounts\",\"CZR-Application-ActiveDirectory-WilliamHill\")"
            }
          ]
        },
        "displayName": "",
        "nextStep": "HTTP Request 4",
        "type": "Mutation"
      },
      "Define Variable 6": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "identityUUID",
              "transforms": [],
              "variableA.$": "$.hTTPRequest4.body[0].identityId"
            }
          ]
        },
        "displayName": "",
        "nextStep": "Define Variable 7",
        "type": "Mutation"
      },
      "Define Variable 7": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "identityUID",
              "transforms": [],
              "variableA.$": "$['defineVariable1','defineVariable4','defineVariable6'].identityUUID"
            }
          ]
        },
        "displayName": "",
        "nextStep": "HTTP Request 8",
        "type": "Mutation"
      },
      "End Step - Failure 3": {
        "actionId": "sp:operator-failure",
        "displayName": "",
        "failureName": "Valid User Identifier is Missing",
        "type": "failure"
      },
      "End Step - Success 1": {
        "actionId": "sp:operator-success",
        "displayName": "",
        "type": "success"
      },
      "HTTP Request": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "method": "get",
          "oAuthClientId": "b92fd0129e4f4920afdf81b8b82beb8c",
          "oAuthClientSecret": "$.secrets.0dab64d6-4288-4706-b252-c5b35590d794",
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "url.$": "$.defineVariable4.adUrlByIdentityId",
          "urlParams": {
            "filters": "identityId eq \"{{$.hTTPRequest1.body[0].identityId}}\" and source.displayableName in (\"CZR-Application-ActiveDirectory-Harrahs\",\"CZR-Application-ActiveDirectory-Harrahs-JAccounts\",\"CZR-Application-ActiveDirectory-WilliamHill\")"
          }
        },
        "displayName": "",
        "nextStep": "Define Variable 7",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 1": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "method": "get",
          "oAuthClientId": "04e17c484bd8428f8dfad8d96557f3a9",
          "oAuthClientSecret": "$.secrets.9cb882ef-5b43-44fa-991d-b45eab01813b",
          "oAuthCredentialLocation": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "url.$": "$.defineVariable3.adAccountURL",
          "urlParams": {
            "filters": "identityId eq \"{{$.defineVariable.personNumber}}\" and source.displayableName in (\"CZR-Application-ActiveDirectory-Harrahs\",\"CZR-Application-ActiveDirectory-Harrahs-JAccounts\",\"CZR-Application-ActiveDirectory-WilliamHill\")"
          }
        },
        "displayName": "",
        "nextStep": "Verify Data Type",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 2": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "indices": [
              "identities"
            ],
            "query": {
              "query": "attributes.uid:{{$.defineVariable.personNumber}}"
            }
          },
          "method": "post",
          "oAuthClientId": "04e17c484bd8428f8dfad8d96557f3a9",
          "oAuthClientSecret": "$.secrets.9cb882ef-5b43-44fa-991d-b45eab01813b",
          "oAuthCredentialLocation": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "url": "https://caesars-sb.api.identitynow.com/v2025/search",
          "urlParams": null
        },
        "displayName": "",
        "nextStep": "Verify Data Type 4",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 3": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "method": "get",
          "oAuthClientId": "04e17c484bd8428f8dfad8d96557f3a9",
          "oAuthClientSecret": "$.secrets.9cb882ef-5b43-44fa-991d-b45eab01813b",
          "oAuthCredentialLocation": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "url.$": "$.defineVariable1.adUrlByPersonId",
          "urlParams": {
            "filters": "identityId eq \"{{$.hTTPRequest2.body[0].id}}\" and source.displayableName in (\"CZR-Application-ActiveDirectory-Harrahs\",\"CZR-Application-ActiveDirectory-Harrahs-JAccounts\",\"CZR-Application-ActiveDirectory-WilliamHill\")"
          }
        },
        "displayName": "",
        "nextStep": "Define Variable 7",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 4": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "method": "get",
          "oAuthClientId": "04e17c484bd8428f8dfad8d96557f3a9",
          "oAuthClientSecret": "$.secrets.9cb882ef-5b43-44fa-991d-b45eab01813b",
          "oAuthCredentialLocation": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "url.$": "$.defineVariable5.adUrlByUserDisplayName",
          "urlParams": {
            "filters": "identityId eq \"{{$.hTTPRequest2.body[0].id}}\" and source.displayableName in (\"CZR-Application-ActiveDirectory-Harrahs\",\"CZR-Application-ActiveDirectory-Harrahs-JAccounts\",\"CZR-Application-ActiveDirectory-WilliamHill\")"
          }
        },
        "displayName": "",
        "nextStep": "Define Variable 6",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 8": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "attributes": {
              "DisplayName": "{{$.defineVariable.displayName}}",
              "FirstName": "{{$.defineVariable.fName}}",
              "LastName": "{{$.defineVariable.lName}}",
              "Operation": "{{$.defineVariable.operation}}",
              "PasswordResetDate": "{{$.defineVariable.triggeredDate}}",
              "PasswordResetSource": "API CALL",
              "PersonNumber": "{{$.defineVariable.personNumber}}",
              "RequestedBy": "{{$.defineVariable.requestedBy}}",
              "SAMAccountName": "{{$.defineVariable.sAMAccountName}}",
              "UserEmail": "{{$.defineVariable.userEmail}}",
              "comments": "{{$.defineVariable.comments}}",
              "sourceId": "a4ab4565eeee45178f4dbdf0f2c89937"
            }
          },
          "method": "post",
          "oAuthClientId": "04e17c484bd8428f8dfad8d96557f3a9",
          "oAuthClientSecret": "$.secrets.3a27c72e-de05-452b-8117-b092f46a05de",
          "oAuthCredentialLocation": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "url": "https://caesars-sb.api.identitynow.com/v2025/accounts"
        },
        "displayName": "",
        "nextStep": "Loop",
        "type": "action",
        "versionNumber": 2
      },
      "Loop": {
        "actionId": "sp:loop:iterator",
        "attributes": {
          "context.$": "$.defineVariable7.identityUID",
          "input.$": "$['hTTPRequest','hTTPRequest3','hTTPRequest4'].body[*]",
          "start": "Compare Strings",
          "steps": {
            "Compare Strings": {
              "actionId": "sp:compare-strings",
              "choiceList": [
                {
                  "comparator": "StringEquals",
                  "nextStep": "HTTP Request 5",
                  "variableA.$": "$.loop.loopInput.sourceName",
                  "variableB": "CZR-Application-ActiveDirectory-Harrahs"
                }
              ],
              "defaultStep": "Compare Strings 1",
              "displayName": "",
              "type": "choice"
            },
            "Compare Strings 1": {
              "actionId": "sp:compare-strings",
              "choiceList": [
                {
                  "comparator": "StringEquals",
                  "nextStep": "HTTP Request 6",
                  "variableA.$": "$.loop.loopInput.sourceName",
                  "variableB": "CZR-Application-ActiveDirectory-WilliamHill"
                }
              ],
              "defaultStep": "Compare Strings 2",
              "displayName": "",
              "type": "choice"
            },
            "Compare Strings 2": {
              "actionId": "sp:compare-strings",
              "choiceList": [
                {
                  "comparator": "StringEquals",
                  "nextStep": "HTTP Request 7",
                  "variableA.$": "$.loop.loopInput.sourceName",
                  "variableB": "CZR-Application-ActiveDirectory-Harrahs-JAccounts"
                }
              ],
              "defaultStep": "End Step - Failure",
              "displayName": "",
              "type": "choice"
            },
            "End Step - Failure": {
              "actionId": "sp:operator-failure",
              "displayName": "",
              "failureName": "Unable to Process",
              "type": "failure"
            },
            "End Step - Success": {
              "actionId": "sp:operator-success",
              "displayName": "",
              "type": "success"
            },
            "HTTP Request 5": {
              "actionId": "sp:http",
              "attributes": {
                "authenticationType": "OAuth",
                "jsonRequestBody": {
                  "requestedForWithRequestedItems": [
                    {
                      "identityId": "{{$.loop.context}}",
                      "requestedItems": [
                        {
                          "accountSelection": [
                            {
                              "accounts": [
                                {
                                  "nativeIdentity": "{{$.loop.loopInput.nativeIdentity}}"
                                }
                              ],
                              "sourceId": "e30d0436a20b45b79517a08f0380b1b1"
                            }
                          ],
                          "comment": "Adding user to SOCPasswordReset",
                          "id": "f79d8868073c39578ee844c656a1f7c5",
                          "type": "ENTITLEMENT"
                        }
                      ]
                    }
                  ]
                },
                "method": "post",
                "oAuthClientId": "b92fd0129e4f4920afdf81b8b82beb8c",
                "oAuthClientSecret": "$.secrets.d984d82b-6add-41ab-89db-da479e48079a",
                "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
                "requestContentType": "json",
                "url": "https://caesars-sb.api.identitynow.com/v2025/access-requests",
                "urlParams": null
              },
              "displayName": "",
              "nextStep": "End Step - Success",
              "type": "action",
              "versionNumber": 2
            },
            "HTTP Request 6": {
              "actionId": "sp:http",
              "attributes": {
                "authenticationType": "OAuth",
                "jsonRequestBody": {
                  "requestedForWithRequestedItems": [
                    {
                      "identityId": "{{$.loop.context}}",
                      "requestedItems": [
                        {
                          "accountSelection": [
                            {
                              "accounts": [
                                {
                                  "nativeIdentity": "{{$.loop.loopInput.nativeIdentity}}"
                                }
                              ],
                              "sourceId": "4f4839d8993144e3b1c0b1af7a2fd110"
                            }
                          ],
                          "comment": "Adding user to SOCPasswordReset",
                          "id": "37ad30cd01313ec0abf918f183d46689",
                          "type": "ENTITLEMENT"
                        }
                      ]
                    }
                  ]
                },
                "method": "post",
                "oAuthClientId": "b92fd0129e4f4920afdf81b8b82beb8c",
                "oAuthClientSecret": "$.secrets.d984d82b-6add-41ab-89db-da479e48079a",
                "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
                "requestContentType": "json",
                "url": "https://caesars-sb.api.identitynow.com/v2025/access-requests",
                "urlParams": null
              },
              "displayName": "",
              "nextStep": "End Step - Success",
              "type": "action",
              "versionNumber": 2
            },
            "HTTP Request 7": {
              "actionId": "sp:http",
              "attributes": {
                "authenticationType": "OAuth",
                "jsonRequestBody": {
                  "requestedForWithRequestedItems": [
                    {
                      "identityId": "{{$.loop.context}}",
                      "requestedItems": [
                        {
                          "accountSelection": [
                            {
                              "accounts": [
                                {
                                  "nativeIdentity": "{{$.loop.loopInput.nativeIdentity}}"
                                }
                              ],
                              "sourceId": "7de09998939547699404eecea625ad91"
                            }
                          ],
                          "comment": "Adding user to SOCPasswordReset",
                          "id": "6e0d715d718838d3ba311b892015e33d",
                          "type": "ENTITLEMENT"
                        }
                      ]
                    }
                  ]
                },
                "method": "post",
                "oAuthClientId": "b92fd0129e4f4920afdf81b8b82beb8c",
                "oAuthClientSecret": "$.secrets.d984d82b-6add-41ab-89db-da479e48079a",
                "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
                "requestContentType": "json",
                "url": "https://caesars-sb.api.identitynow.com/v2025/access-requests",
                "urlParams": null
              },
              "displayName": "",
              "nextStep": "End Step - Success",
              "type": "action",
              "versionNumber": 2
            }
          }
        },
        "displayName": "",
        "nextStep": "End Step - Success 1",
        "type": "action",
        "versionNumber": 1
      },
      "Send Email": {
        "actionId": "sp:send-email",
        "attributes": {
          "body": "<p>&lt;p&gt;<span class=\"NormalTextRun SCXW218388877 BCX8\">Dear SOC Team</span>,&lt;/p&gt;This is an automated notification regarding Password Reset request and this is to inform you that input argument are invalid. Please provide valid input arguments and resubmit the request.&lt;/p&gt;&lt;p&gt;Thank you! &lt;br&gt;Caesars Identity and Access Management Team&lt;/p&gt;</p>",
          "context": {},
          "recipientEmailList": [
            "sailpointsb@caesars.com"
          ],
          "subject": "Invalid input arguments for Password Reset of AD Accounts"
        },
        "displayName": "Send Email to SOC Team",
        "nextStep": "End Step - Failure 3",
        "type": "action",
        "versionNumber": 2
      },
      "Verify Data Type": {
        "actionId": "sp:compare-unary",
        "choiceList": [
          {
            "comparator": "IsPresent",
            "nextStep": "Define Variable 4",
            "variableA.$": "$.hTTPRequest1.body[*].id"
          }
        ],
        "defaultStep": "Compare Strings 3",
        "description": null,
        "displayName": "",
        "type": "choice"
      },
      "Verify Data Type 1": {
        "actionId": "sp:compare-unary",
        "choiceList": [
          {
            "comparator": "IsPresent",
            "nextStep": "Define Variable 5",
            "variableA.$": "$.defineVariable.displayName"
          }
        ],
        "defaultStep": "Send Email",
        "displayName": "",
        "type": "choice"
      },
      "Verify Data Type 3": {
        "actionId": "sp:compare-unary",
        "choiceList": [
          {
            "comparator": "IsPresent",
            "nextStep": "Define Variable 3",
            "variableA.$": "$.defineVariable.sAMAccountName"
          }
        ],
        "defaultStep": "Compare Strings 3",
        "displayName": "",
        "type": "choice"
      },
      "Verify Data Type 4": {
        "actionId": "sp:compare-unary",
        "choiceList": [
          {
            "comparator": "IsPresent",
            "nextStep": "Define Variable 1",
            "variableA.$": "$.hTTPRequest2.body[*].id"
          }
        ],
        "defaultStep": "Verify Data Type 1",
        "description": null,
        "displayName": "",
        "type": "choice"
      }
    }
  },
  "enabled": false,
  "creator": {
    "type": "IDENTITY",
    "id": "a59de7c458b8412196819de652475e5a",
    "name": "500000383"
  },
  "owner": {
    "type": "IDENTITY",
    "id": "a0d9586ce9314f9f89c2d094dca4e27e",
    "name": "500000384"
  },
  "trigger": {
    "type": "EXTERNAL",
    "attributes": {
      "clientId": "f276cdd7-991d-4403-b7d2-8f8c53a4ddff",
      "id": "idn:external-http",
      "url": "/beta/workflows/execute/external/24e5b256-9cde-4d16-95b2-bd036be4bae9"
    }
  }
}