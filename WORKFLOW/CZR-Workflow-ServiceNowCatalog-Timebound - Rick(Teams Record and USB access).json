{
  "id": "31a220e0-9537-41b2-b67f-f9c449679ae2",
  "name": "CZR-Workflow-ServiceNowCatalog-Timebound - Rick(Teams Record and USB access)",
  "description": "Teams Recording access and USB access Timebound will be controlled thru this workflow. After the period listed for each role, access will be automatically revoked.Approval must follow the next-level reporting structure, and then proceed to management for final authorization.",
  "created": "2025-09-18T19:34:02.357570177Z",
  "modified": "2025-10-24T21:48:26.946625392Z",
  "modifiedBy": {
    "type": "IDENTITY",
    "id": "9880e87611d64a5b9a6c66acd11b7301",
    "name": "Lingareddy Some"
  },
  "definition": {
    "start": "Define Variable 1",
    "steps": {
      "Define Variable": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "removalDate",
              "name": "removalDate",
              "transforms": [
                {
                  "id": "sp:transform:addTime:time",
                  "input": {
                    "length": 30,
                    "unit": "days"
                  }
                }
              ],
              "variableA.$": "$.now()"
            }
          ]
        },
        "displayName": "",
        "nextStep": "HTTP Request",
        "type": "Mutation"
      },
      "Define Variable 1": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "attributeValue",
              "name": "attributeValue",
              "transforms": [],
              "variableA.$": "$.trigger.accountRequests[?(@.attributeRequests[0].attributeValue)]"
            }
          ]
        },
        "displayName": "",
        "nextStep": "Verify Data Type",
        "type": "Mutation"
      },
      "End Step - Failure": {
        "actionId": "sp:operator-failure",
        "description": "Failed to find group",
        "displayName": "",
        "failureName": "Failed to find group",
        "type": "failure"
      },
      "End Step - Success": {
        "actionId": "sp:operator-success",
        "displayName": "",
        "type": "success"
      },
      "HTTP Request": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "clientMetadata": null,
            "requestType": "REVOKE_ACCESS",
            "requestedFor": [
              "{{$.trigger.recipient.id}}"
            ],
            "requestedItems": [
              {
                "clientMetadata": null,
                "comment": " USB 30 Day Access Read and Write-Active Directory group has been automatically removed by ISC. If you believe this is an error, please reach out to your manager or the Team AD group owner for assistance.",
                "id": "80faec5ca54e43ccbf24da5db102591c",
                "removeDate": "{{$.defineVariable.removalDate}}",
                "type": "ROLE"
              },
              {
                "clientMetadata": null,
                "comment": " USB 30 Day Access Read only -Active Directory group has been automatically removed by ISC. If you believe this is an error, please reach out to your manager or the Team AD group owner for assistance.",
                "id": "16257a9f615e43d5bcddc0d4bd001746",
                "removeDate": "{{$.defineVariable.removalDate}}",
                "type": "ROLE"
              }
            ]
          },
          "method": "post",
          "oAuthClientId": "f7f34d9888cd4b0cb8123b7ed92c427f",
          "oAuthClientSecret": "$.secrets.a18ee8b2-ceca-473a-9e2b-9cfcb20b8d8b",
          "oAuthCredentialLocation": "oAuthInBody",
          "oAuthScope": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "requestHeaders": null,
          "url": "https://caesars-sb.api.identitynow.com/v2024/access-requests"
        },
        "description": "USB Read and Write 30 Day revoke access",
        "displayName": "",
        "nextStep": "End Step - Success",
        "type": "action",
        "versionNumber": 2
      },
      "Verify Data Type": {
        "actionId": "sp:compare-unary",
        "choiceList": [
          {
            "comparator": "IsPresent",
            "nextStep": "Define Variable",
            "variableA.$": "$.defineVariable1.attributeValue"
          }
        ],
        "defaultStep": "End Step - Failure",
        "displayName": "",
        "type": "choice"
      }
    }
  },
  "enabled": false,
  "creator": {
    "type": "IDENTITY",
    "id": "9880e87611d64a5b9a6c66acd11b7301",
    "name": "Lingareddy Some"
  },
  "owner": {
    "type": "IDENTITY",
    "id": "136c2e6d25154894a28dda6701c6a54f",
    "name": "svcdentspsbcf"
  },
  "trigger": {
    "type": "EVENT",
    "attributes": {
      "filter.$": "$.accountRequests[?(@.accountOperation=='Modify' &&  (@.attributeRequests[0].attributeValue=='CN=USB 30 Day Access Read and Write,OU=Okta,OU=Applications,OU=SailPointUsers,DC=dev,DC=lab,DC=local' || @.attributeRequests[0].attributeValue=='CN=USB 30 Day Access ReadOnly,OU=Okta,OU=Applications,OU=SailPointUsers,DC=dev,DC=lab,DC=local' || @.attributeRequests[0].attributeValue=='CN=USB 48 Hour Access Read and Write,OU=Okta,OU=Applications,OU=SailPointUsers,DC=dev,DC=lab,DC=local' || @.attributeRequests[0].attributeValue=='CN=USB 48 Hour Access Read Only,OU=Okta,OU=Applications,OU=SailPointUsers,DC=dev,DC=lab,DC=local' || @.attributeRequests[0].attributeValue=='CN=Teams Recording 30 day access,OU=Okta,OU=Applications,OU=SailPointUsers,DC=dev,DC=lab,DC=local'))]",
      "id": "idn:post-provisioning"
    }
  }
}