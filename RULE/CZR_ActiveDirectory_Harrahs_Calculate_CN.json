{
  "description": "Calculate the CN of the user and validate uniqueness against Active directory.",
  "type": "AttributeGenerator",
  "signature": {
    "input": [],
    "output": null
  },
  "sourceCode": {
    "version": "2025-03-10 22:38:49",
    "script": "\n       import java.util.ArrayList;\n       import sailpoint.tools.GeneralException;\n       import org.apache.commons.lang.StringUtils;\n       import java.util.List;\n       import java.util.Arrays;\n       import sailpoint.server.IdnRuleUtil;\n\n       private static boolean checkUnique(String cn) throws GeneralException {\n         boolean isCNUnique = false;\n         String op = \"StartsWith\";\n         String searchableCN = \"searchableCN\";\n\n         String harrahsADSourceId = idn.getSourceAttributeBySourceName(application.getName(), \"harrahsADSourceId\");\n         String whADSourceId = idn.getSourceAttributeBySourceName(application.getName(), \"whADSourceId\");\n         String devADSourceId = idn.getSourceAttributeBySourceName(application.getName(), \"devADSourceId\");\n\n         List SOURCE_IDS = new ArrayList(Arrays.asList(new String[] {\n           harrahsADSourceId,\n           whADSourceId,\n           devADSourceId\n         }));\n         List SEARCH_VALUES = new ArrayList(Arrays.asList(new String[] {\n           cn\n         }));\n\n         isCNUnique = idn.attrSearchCountAccounts(SOURCE_IDS, searchableCN, op, SEARCH_VALUES) == 0 ? true : false;\n         return isCNUnique;\n\n       }\n\n       public String cleanData(String inputString) {\n         if (inputString != null) {\n           inputString = inputString.replaceAll(\"[^A-Za-z0-9]\", \"\");\n           inputString = StringUtils.trimToNull(inputString);\n           if (inputString != null) {\n             inputString = inputString.replaceAll(\"[\\\\s\\\\-()]\", \"\");\n             inputString = inputString.replaceAll(\"'\", \"\");\n             inputString = inputString.toLowerCase();\n           }\n         }\n\n         return inputString;\n       }\n\n       public String getCN() {\n         boolean isUnique = false;\n\n         String firstName = identity.getFirstname();\n         String lastName = identity.getLastname();\n\n         if (firstName != null)\n           firstName = firstName.trim();\n         if (lastName != null)\n           lastName = lastName.trim();\n\n         String cn = new String();\n\n         if (null != firstName && firstName != \"\") {\n           firstName = cleanData(firstName);\n           if (null != firstName && firstName != \"\") {\n             if (firstName.length() > 1) {\n               firstName = firstName.substring(0, 1).toUpperCase() + firstName.substring(1);\n             } else {\n               firstName = firstName.toUpperCase();\n             }\n\n           }\n         }\n\n         if (null != lastName && lastName != \"\") {\n           lastName = cleanData(lastName);\n           if (null != lastName && lastName != \"\") {\n             if (lastName.length() > 1) {\n               lastName = lastName.substring(0, 1).toUpperCase() + lastName.substring(1);\n             } else {\n               lastName = lastName.toUpperCase();\n             }\n           }\n         }\n\n         if (null == firstName || null == lastName || firstName == \"\" || lastName == \"\") {\n           return cn;\n         }\n\n         cn = firstName + \" \" + lastName;\n\n         String tempCN = cn;\n\n         for (int count = 1; count < 1000; count++) {\n\n           isUnique = checkUnique(tempCN);\n           if (isUnique) {\n             cn = tempCN;\n             break;\n           }\n\n           tempCN = firstName + \" \" + lastName + count;\n         }\n         return cn;\n       }\n       return getCN();\n  "
  },
  "attributes": {
    "sourceVersion": "2025-03-10 22:38:49"
  },
  "id": "22a32dae79cb48a2834d0b0aeacc9a58",
  "name": "CZR_ActiveDirectory_Harrahs_Calculate_CN",
  "created": "2025-03-10T22:38:49.330Z",
  "modified": "2025-03-10T22:38:49.330Z"
}