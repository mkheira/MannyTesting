{
  "description": "Calculate the SamAccountName of the user and validate uniqueness against Active directory.",
  "type": "AttributeGenerator",
  "signature": {
    "input": [],
    "output": null
  },
  "sourceCode": {
    "version": "2025-12-10 23:30:07",
    "script": "\n\n\timport java.util.ArrayList;\n\timport sailpoint.tools.GeneralException;\n\timport org.apache.commons.lang.StringUtils;\n\timport java.util.List;\n\timport java.util.Arrays;\n\timport sailpoint.server.IdnRuleUtil;\n\n\tpublic boolean checkUnique(String samAccName) throws GeneralException {\n\t  boolean isSamAccNameUnique = false;\n\t  boolean isUPNUnique = false;\n\t  boolean isMailUnique = false;\n\t  \n\t  String op = \"StartsWith\";\n\t  String searchableUserID = \"searchableUserID\";\n\t  String searchableUPN = \"searchableUPN\";\n\t  String searchableMail = \"searchableMail\";\n\t  \n\t  String harrahsADSourceId = idn.getSourceAttributeBySourceName(application.getName(), \"harrahsADSourceId\");\n\t  String whADSourceId = idn.getSourceAttributeBySourceName(application.getName(), \"whADSourceId\");\n\t  String devADSourceId = idn.getSourceAttributeBySourceName(application.getName(), \"devADSourceId\");\n\n\t  List SOURCE_IDS = new ArrayList(Arrays.asList(new String[] {\n\t\tharrahsADSourceId,\n\t\twhADSourceId,\n\t\tdevADSourceId\n\t  }));\n\t  List SEARCH_VALUES = new ArrayList(Arrays.asList(new String[] {\n\t\tsamAccName\n\t  }));\n\n\t  isSamAccNameUnique = idn.attrSearchCountAccounts(SOURCE_IDS, searchableUserID, op, SEARCH_VALUES) == 0 ? true : false;\n\t  if(isSamAccNameUnique) {\n\t\tisUPNUnique = idn.attrSearchCountAccounts(SOURCE_IDS, searchableUPN, op, SEARCH_VALUES) == 0 ? true : false;\n\t\tif(isUPNUnique) {\n\t\t\tisMailUnique = idn.attrSearchCountAccounts(SOURCE_IDS, searchableMail, op, SEARCH_VALUES) == 0 ? true : false;\n\t\t}\n\t  }\n\t  \n\t  if(isSamAccNameUnique && isUPNUnique && isMailUnique)\n\t\treturn true;\n\t  else\n\t\treturn false;\n\t}\n\n\tpublic String cleanData(String inputString) {\n\t  if (inputString != null) {\n\t\tinputString = inputString.replaceAll(\"[^A-Za-z0-9]\", \"\");\n\t\tinputString = StringUtils.trimToNull(inputString);\n\t\tif (inputString != null) {\n\t\t  inputString = inputString.replaceAll(\"[\\\\s\\\\-()]\", \"\");\n\t\t  inputString = inputString.replaceAll(\"'\", \"\");\n\t\t  inputString = inputString.toLowerCase();\n\t\t}\n\t  }\n\t  return inputString;\n\t}\n\n\tpublic String getSamAccName() {\n\n\t  boolean isUnique = false;\n\t  String firstName = identity.getFirstname();\n\t  String lastName = identity.getLastname();\n\t  String samAccNameToReturn = \"\";\n\t  String samAccName = \"\";\n\t  if (null != firstName && firstName != \"\")\n\t\tfirstName = cleanData(firstName);\n\t  if (null != lastName && lastName != \"\")\n\t\tlastName = cleanData(lastName);\n\t  if (null == firstName || null == lastName || firstName == \"\" || lastName == \"\") {\n\t\treturn samAccNameToReturn;\n\t  }\n\t\tboolean firstExecution = true;\n\t\tString tempsamAccName = \"\";\n\t\t\tfor(int len = lastName.length(); len>=1; len--) {\n\t\t\t\tif (firstName.length() > 1) {\n\t\t\t\t\ttempsamAccName = firstName.substring(0, 1) + lastName.substring(0, len);\n\t\t\t\t} else {\n\t\t\t\t\ttempsamAccName = firstName + lastName.substring(0, len);\n\t\t\t\t}\n\t\t\t\ttempsamAccName = tempsamAccName.trim();\n\t\t\t\tif(tempsamAccName.length() > 20) {\n\t\t\t\t\tsamAccName = tempsamAccName.substring(0, 20);\n\t\t\t\t\tif(firstExecution) {\n\t\t\t\t\t\tsamAccNameToReturn = tempsamAccName.substring(0, 20);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsamAccName = tempsamAccName;\n\t\t\t\t\tif(firstExecution) {\n\t\t\t\t\t\tsamAccNameToReturn = tempsamAccName;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (int count = 1; count < 1000; count++) {\n\t\t\t\t\tif(!firstExecution) {\n\t\t\t\t\t\ttempsamAccName = samAccName + count;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcount--;\n\t\t\t\t\t\tfirstExecution = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (tempsamAccName.length() > 20) {\n\t\t\t\t\t\ttempsamAccName = tempsamAccName.substring(0, 20);\n\t\t\t\t\t}\n\t\t\t\t\tisUnique = checkUnique(tempsamAccName);\n\t\t\t\t\tif (isUnique) {\n\t\t\t\t\t\treturn tempsamAccName;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\treturn samAccNameToReturn;\n\t}\n\treturn getSamAccName();\t\t\n\n  "
  },
  "attributes": {
    "sourceVersion": "2025-12-10 23:30:07"
  },
  "id": "6dbf975864a94558a9e8281a1b818cfd",
  "name": "CZR_ActiveDirectory_Harrahs_Calculate_sAMAccountName_Temp",
  "created": "2025-12-10T23:30:08.040Z",
  "modified": "2025-12-10T23:30:08.040Z"
}