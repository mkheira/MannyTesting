{
  "id": "2ee41e8f-a87f-4253-ae5b-744e66c6037c",
  "name": "Copy of CZR-Workflow-Suspend-Activate-AD-Account-Loop",
  "description": "",
  "created": "2025-11-05T17:21:22.967511772Z",
  "modified": "2025-11-06T11:51:48.894601695Z",
  "modifiedBy": {
    "type": "IDENTITY",
    "id": "a59de7c458b8412196819de652475e5a",
    "name": "500000383"
  },
  "definition": {
    "start": "Interactive Form",
    "steps": {
      "Compare Boolean": {
        "actionId": "sp:compare-boolean",
        "choiceList": [
          {
            "comparator": "BooleanEquals",
            "nextStep": "Loop",
            "variableA.$": "$.interactiveForm1.formData.suspendAdAccount",
            "variableB": true
          }
        ],
        "defaultStep": "Compare Boolean 1",
        "displayName": "Suspension Request?",
        "type": "choice"
      },
      "Compare Boolean 1": {
        "actionId": "sp:compare-boolean",
        "choiceList": [
          {
            "comparator": "BooleanEquals",
            "nextStep": "Loop 2",
            "variableA.$": "$.interactiveForm1.formData.activateAdAccount",
            "variableB": true
          }
        ],
        "defaultStep": "Loop 1",
        "displayName": "Activate Request?",
        "type": "choice"
      },
      "Compare Boolean 2": {
        "actionId": "sp:compare-boolean",
        "choiceList": [
          {
            "comparator": "BooleanEquals",
            "nextStep": "End Step - Success 4",
            "variableA.$": "$.interactiveForm1.formData.activateAdAccount",
            "variableB": true
          }
        ],
        "defaultStep": "HTTP Request 4",
        "displayName": "",
        "type": "choice"
      },
      "Define Variable": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "userName",
              "transforms": [
                {
                  "id": "sp:transform:trim:string",
                  "input": {
                    "postfix": true,
                    "prefix": true
                  }
                },
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "^.*-",
                    "replacement": " "
                  }
                }
              ],
              "variableA.$": "$.interactiveForm.formData.selectUser"
            }
          ]
        },
        "displayName": "Get UserName of Selected User",
        "nextStep": "HTTP Request",
        "type": "Mutation"
      },
      "Define Variable 1": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "identityID",
              "transforms": [],
              "variableA.$": "$.hTTPRequest.body[0].id"
            }
          ]
        },
        "displayName": "Get Identity ID",
        "nextStep": "Define Variable 2",
        "type": "Mutation"
      },
      "Define Variable 2": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "adAccountsURL",
              "transforms": [
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "identity_id",
                    "replacement.$": "$.defineVariable1.identityID"
                  }
                },
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "source_Type",
                    "replacement": "Direct"
                  }
                }
              ],
              "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=identityId eq \"identity_id\" and source.connectionType eq \"source_Type\""
            }
          ]
        },
        "displayName": "Get Account URL",
        "nextStep": "HTTP Request 1",
        "type": "Mutation"
      },
      "Define Variable 3": {
        "actionId": "sp:define-variable",
        "attributes": {
          "id": "sp:define-variable",
          "variables": [
            {
              "description": "",
              "name": "requesterUserName",
              "transforms": [
                {
                  "id": "sp:transform:trim:string",
                  "input": {
                    "postfix": true,
                    "prefix": true
                  }
                },
                {
                  "id": "sp:transform:replace:string",
                  "input": {
                    "pattern": "^.*-",
                    "replacement": " "
                  }
                }
              ],
              "variableA.$": "$.interactiveForm.formData.requestedBy"
            }
          ]
        },
        "displayName": "Get Requester UserName",
        "nextStep": "Compare Boolean",
        "type": "Mutation"
      },
      "End Step - Success": {
        "actionId": "sp:operator-success",
        "displayName": "",
        "type": "success"
      },
      "End Step - Success 4": {
        "actionId": "sp:operator-success",
        "displayName": "",
        "type": "success"
      },
      "End Step - Success 5": {
        "actionId": "sp:operator-success",
        "displayName": "",
        "type": "success"
      },
      "End Step - Success 6": {
        "actionId": "sp:operator-success",
        "displayName": "",
        "type": "success"
      },
      "HTTP Request": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "basicAuthUserName": null,
          "jsonRequestBody": {
            "indices": [
              "identities"
            ],
            "query": {
              "query": "attributes.uid:{{$.defineVariable.userName}}"
            }
          },
          "method": "post",
          "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
          "oAuthClientSecret": "$.secrets.3cdcae7f-5b0d-4416-8450-8379ab7131b1",
          "oAuthCredentialLocation": null,
          "oAuthScope": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "requestHeaders": null,
          "url": "https://caesars-sb.api.identitynow.com/v2025/search",
          "urlParams": null
        },
        "displayName": "Get Identity HTTP Request",
        "nextStep": "Define Variable 1",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 1": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "indices": [
              "identities"
            ],
            "query": {
              "query": "attributes.uid:{{$.defineVariable1.userName}}"
            }
          },
          "method": "get",
          "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
          "oAuthClientSecret": "$.secrets.e4d6f59a-03a9-481e-a4b6-407d91648bb2",
          "oAuthCredentialLocation": null,
          "oAuthScope": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": null,
          "requestHeaders": null,
          "url.$": "$.defineVariable2.adAccountsURL",
          "urlParams": {
            "filters": "identityId eq \"{{$.defineVariable1.identityID}}\" and source.connectionType eq \"Direct\""
          }
        },
        "displayName": "Get AD Accounts HTTP Request",
        "nextStep": "Interactive Form 1",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 2": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "attributes": {
              "AssignmentStatusType": "inactive",
              "CompleteTermination": "Y",
              "PersonNumber": "{{$.defineVariable.userName}}",
              "TerminatedBy": "{{$.defineVariable3.requesterUserName}}",
              "TerminationDate": "",
              "TerminationSource": "{{$.interactiveForm1.formData.selectAdAccountsForSuspension[0]}}",
              "sourceId": "8c0e3f57c1d744ddaf8c1b156c322836"
            }
          },
          "method": "post",
          "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
          "oAuthCredentialLocation": null,
          "oAuthScope": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "requestHeaders": null,
          "url": "https://caesars-sb.api.identitynow.com/v2025/accounts",
          "urlParams": null
        },
        "displayName": "Create Suspension EditIdentity HTTP Request",
        "nextStep": "HTTP Request 3",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 3": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "identityIds": [
              "{{$.defineVariable1.identityID}}"
            ]
          },
          "method": "post",
          "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
          "oAuthCredentialLocation": null,
          "oAuthScope": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "requestHeaders": {
            "X-SailPoint-Experimental": "true"
          },
          "url": "https://caesars-sb.api.identitynow.com/v2025/identities/process",
          "urlParams": null
        },
        "displayName": "Identity Refresh HTTP Request",
        "nextStep": "End Step - Success",
        "type": "action",
        "versionNumber": 2
      },
      "HTTP Request 4": {
        "actionId": "sp:http",
        "attributes": {
          "authenticationType": "OAuth",
          "jsonRequestBody": {
            "attributes": {
              "AssignmentStatusType": "active",
              "CompleteTermination": "N",
              "PersonNumber": "{{$.defineVariable.userName}}",
              "TerminatedBy": "{{$.defineVariable3.requesterUserName}}",
              "TerminationDate": "",
              "TerminationSource": "{{$.interactiveForm1.formData.selectAdAccountsForActivate[0]}}",
              "sourceId": "8c0e3f57c1d744ddaf8c1b156c322836"
            }
          },
          "method": "post",
          "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
          "oAuthCredentialLocation": null,
          "oAuthScope": null,
          "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
          "requestContentType": "json",
          "requestHeaders": null,
          "url": "https://caesars-sb.api.identitynow.com/v2025/accounts",
          "urlParams": null
        },
        "displayName": "Create Activate EditIdentity HTTP Request",
        "nextStep": "HTTP Request 2",
        "type": "action",
        "versionNumber": 2
      },
      "Interactive Form": {
        "actionId": "sp:interactive-form",
        "attributes": {
          "formDefinitionId": "2a95b733-0340-44e5-9cba-35d9ed17880a",
          "inputForForm_reActiveAdAccounts": "$.interactiveForm.formData.reActiveAdAccounts",
          "inputForForm_selectUser": "$.interactiveForm.formData.selectUser",
          "inputForForm_suspendAdAccounts": "$.interactiveForm.formData.suspendAdAccounts",
          "inputForForm_userType": "$.interactiveForm.formData.userType",
          "interactiveProcessId.$": "$.trigger.interactiveProcessId",
          "ownerId.$": "$.trigger.launchedBy.id",
          "title": "User Selection Form"
        },
        "displayName": "Input Form",
        "nextStep": "Define Variable",
        "type": "action",
        "versionNumber": 1
      },
      "Interactive Form 1": {
        "actionId": "sp:interactive-form",
        "attributes": {
          "formDefinitionId": "ee04fcfc-7eb2-4dc2-bd47-86951ad0061f",
          "inputForForm_array_usersDisabledAdAccounts.$": "$.hTTPRequest1.body[?(@.disabled == true && @.sourceName =~ /.*ActiveDirectory.*/)]",
          "inputForForm_array_usersDisabledAdAccounts_label": "$.sourceName",
          "inputForForm_array_usersDisabledAdAccounts_value": "$.sourceName",
          "inputForForm_array_usersEnabledAdAccounts.$": "$.hTTPRequest1.body[?(@.disabled == false && @.sourceName =~ /.*ActiveDirectory.*/)]",
          "inputForForm_array_usersEnabledAdAccounts_label": "$.sourceName",
          "inputForForm_array_usersEnabledAdAccounts_value": "$.sourceName",
          "inputForForm_userType": "$.interactiveForm.formData.userType",
          "interactiveProcessId.$": "$.trigger.interactiveProcessId",
          "ownerId.$": "$.trigger.launchedBy.id"
        },
        "displayName": "Display AD Accounts Form",
        "nextStep": "Define Variable 3",
        "type": "action",
        "versionNumber": 1
      },
      "Loop": {
        "actionId": "sp:loop:iterator",
        "attributes": {
          "context.$": "$.defineVariable1.identityID",
          "input.$": "$.interactiveForm1.formData.selectAdAccountsForSuspension",
          "start": "Define Variable 4",
          "steps": {
            "Define Variable 4": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "selectedADAccount",
                    "transforms": [],
                    "variableA.$": "$.loop.loopInput"
                  }
                ]
              },
              "displayName": "",
              "nextStep": "Define Variable 5",
              "type": "Mutation"
            },
            "Define Variable 5": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "identityId",
                    "transforms": [],
                    "variableA.$": "$.loop.context"
                  }
                ]
              },
              "displayName": "",
              "nextStep": "Define Variable 6",
              "type": "Mutation"
            },
            "Define Variable 6": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "adAccountGetURL",
                    "transforms": [
                      {
                        "id": "sp:transform:replace:string",
                        "input": {
                          "pattern": "identity_id",
                          "replacement.$": "$.defineVariable5.identityId"
                        }
                      },
                      {
                        "id": "sp:transform:replace:string",
                        "input": {
                          "pattern": "source_displayableName",
                          "replacement.$": "$.defineVariable4.selectedADAccount"
                        }
                      }
                    ],
                    "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=identityId eq \"identity_id\" and source.displayableName eq \"source_displayableName\""
                  }
                ]
              },
              "displayName": "",
              "nextStep": "HTTP Request 5",
              "type": "Mutation"
            },
            "End Step - Success 1": {
              "actionId": "sp:operator-success",
              "displayName": "",
              "type": "success"
            },
            "HTTP Request 5": {
              "actionId": "sp:http",
              "attributes": {
                "authenticationType": "OAuth",
                "method": "get",
                "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
                "oAuthClientSecret": "$.secrets.05e9bec9-346f-4f23-a4f0-b53d8bf1974e",
                "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
                "url.$": "$.defineVariable6.adAccountGetURL",
                "urlParams": {
                  "filters": "identityId eq \"{{$.defineVariable4.identityId}}\" and source.displayableName eq \"{{$.defineVariable5.selectedADAccount}}\""
                }
              },
              "displayName": "",
              "nextStep": "Manage Accounts",
              "type": "action",
              "versionNumber": 2
            },
            "Manage Accounts": {
              "actionId": "sp:manage-account",
              "attributes": {
                "accountIds.$": "$.hTTPRequest5.body[0].id",
                "operation": "disable"
              },
              "displayName": "",
              "nextStep": "End Step - Success 1",
              "type": "action",
              "versionNumber": 1
            }
          }
        },
        "displayName": "",
        "nextStep": "End Step - Success 6",
        "type": "action",
        "versionNumber": 1
      },
      "Loop 1": {
        "actionId": "sp:loop:iterator",
        "attributes": {
          "context.$": "$.defineVariable1.identityID",
          "input.$": "$.hTTPRequest1.body[?(@.disabled == false && @.sourceName =~ /.*ActiveDirectory.*/)].sourceName",
          "start": "Define Variable 7",
          "steps": {
            "Define Variable 7": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "selectedADAccount",
                    "transforms": [],
                    "variableA.$": "$.loop.loopInput"
                  }
                ]
              },
              "displayName": "",
              "nextStep": "Define Variable 8",
              "type": "Mutation"
            },
            "Define Variable 8": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "identityId",
                    "transforms": [],
                    "variableA.$": "$.loop.context"
                  }
                ]
              },
              "displayName": "",
              "nextStep": "Define Variable 9",
              "type": "Mutation"
            },
            "Define Variable 9": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "adAccountGetURL",
                    "transforms": [
                      {
                        "id": "sp:transform:replace:string",
                        "input": {
                          "pattern": "identity_id",
                          "replacement.$": "$.defineVariable8.identityId"
                        }
                      },
                      {
                        "id": "sp:transform:replace:string",
                        "input": {
                          "pattern": "source_displayableName",
                          "replacement.$": "$.defineVariable7.selectedADAccount"
                        }
                      }
                    ],
                    "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=identityId eq \"identity_id\" and source.displayableName eq \"source_displayableName\""
                  }
                ]
              },
              "displayName": "",
              "nextStep": "HTTP Request 6",
              "type": "Mutation"
            },
            "End Step - Success 2": {
              "actionId": "sp:operator-success",
              "displayName": "",
              "type": "success"
            },
            "HTTP Request 6": {
              "actionId": "sp:http",
              "attributes": {
                "authenticationType": "OAuth",
                "method": "get",
                "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
                "oAuthClientSecret": "$.secrets.7cee783e-711b-4e9c-958e-ea32708b163c",
                "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
                "url.$": "$.defineVariable9.adAccountGetURL",
                "urlParams": {
                  "filters": "identityId eq \"{{$.defineVariable8.identityId}}\" and source.displayableName eq \"{{$.defineVariable7.selectedADAccount}}\""
                }
              },
              "displayName": "",
              "nextStep": "Manage Accounts 1",
              "type": "action",
              "versionNumber": 2
            },
            "Manage Accounts 1": {
              "actionId": "sp:manage-account",
              "attributes": {
                "accountIds.$": "$.hTTPRequest6.body[0].id",
                "operation": "disable"
              },
              "displayName": "",
              "nextStep": "End Step - Success 2",
              "type": "action",
              "versionNumber": 1
            }
          }
        },
        "displayName": "",
        "nextStep": "End Step - Success 5",
        "type": "action",
        "versionNumber": 1
      },
      "Loop 2": {
        "actionId": "sp:loop:iterator",
        "attributes": {
          "context.$": "$.defineVariable1.identityID",
          "input.$": "$.interactiveForm1.formData.selectAdAccountsForActivate",
          "start": "Define Variable 10",
          "steps": {
            "Define Variable 10": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "selectedADAccount",
                    "transforms": [],
                    "variableA.$": "$.loop.loopInput"
                  }
                ]
              },
              "displayName": "",
              "nextStep": "Define Variable 11",
              "type": "Mutation"
            },
            "Define Variable 11": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "identityId",
                    "transforms": [],
                    "variableA.$": "$.loop.context"
                  }
                ]
              },
              "displayName": "",
              "nextStep": "Define Variable 12",
              "type": "Mutation"
            },
            "Define Variable 12": {
              "actionId": "sp:define-variable",
              "attributes": {
                "id": "sp:define-variable",
                "variables": [
                  {
                    "description": "",
                    "name": "adAccountGetURL",
                    "transforms": [
                      {
                        "id": "sp:transform:replace:string",
                        "input": {
                          "pattern": "identity_id",
                          "replacement.$": "$.defineVariable11.identityId"
                        }
                      },
                      {
                        "id": "sp:transform:replace:string",
                        "input": {
                          "pattern": "source_displayableName",
                          "replacement.$": "$.defineVariable10.selectedADAccount"
                        }
                      }
                    ],
                    "variableA": "https://caesars-sb.api.identitynow.com/v2025/accounts?filters=identityId eq \"identity_id\" and source.displayableName eq \"source_displayableName\""
                  }
                ]
              },
              "displayName": "",
              "nextStep": "HTTP Request 7",
              "type": "Mutation"
            },
            "End Step - Success 3": {
              "actionId": "sp:operator-success",
              "displayName": "",
              "type": "success"
            },
            "HTTP Request 7": {
              "actionId": "sp:http",
              "attributes": {
                "authenticationType": "OAuth",
                "method": "get",
                "oAuthClientId": "03accbf28df44e4b93eacd4d2de7eb9b",
                "oAuthClientSecret": "$.secrets.6a2ca759-3687-48b4-88b5-f598c21debc8",
                "oAuthCredentialLocation": null,
                "oAuthTokenUrl": "https://caesars-sb.api.identitynow.com/oauth/token",
                "url.$": "$.defineVariable12.adAccountGetURL",
                "urlParams": {
                  "filters": "identityId eq \"{{$.defineVariable11.identityId}}\" and source.displayableName eq \"{{$.defineVariable10.selectedADAccount}}\""
                }
              },
              "displayName": "",
              "nextStep": "Manage Accounts 2",
              "type": "action",
              "versionNumber": 2
            },
            "Manage Accounts 2": {
              "actionId": "sp:manage-account",
              "attributes": {
                "accountIds.$": "$.hTTPRequest7.body[0].id",
                "operation": "enable"
              },
              "displayName": "",
              "nextStep": "End Step - Success 3",
              "type": "action",
              "versionNumber": 1
            }
          }
        },
        "displayName": "",
        "nextStep": "Compare Boolean 2",
        "type": "action",
        "versionNumber": 1
      }
    }
  },
  "enabled": false,
  "creator": {
    "type": "IDENTITY",
    "id": "a59de7c458b8412196819de652475e5a",
    "name": "500000383"
  },
  "owner": {
    "type": "IDENTITY",
    "id": "a59de7c458b8412196819de652475e5a",
    "name": "500000383"
  },
  "trigger": {
    "type": "EVENT",
    "attributes": {
      "filter.$": "$[?(@.workflowId == '2ee41e8f-a87f-4253-ae5b-744e66c6037c')]",
      "id": "idn:interactive-process-launched"
    }
  }
}